library(tidyverse)
library(lubridate)
options(width=100)
t.test(rnorm(n=100, mean=10, sd=10))
t.test(rnorm(n=100, mean=10, sd=10))
hist(fake_1)
fake_1 <- rnorm(n=100, mean=10, sd=10)
(result1<- t.test(fake_1))
t.test(rnorm(n=100, mean=20, sd=10))
t.test(rnorm(n=100, mean=10, sd=5))
t.test(rnorm(n=500, mean=10, sd=10))
t.test(rnorm(n=100, mean=10, sd=10))
pay.gap %>% summarise(mean=mean(DiffMeanHourlyPercent), N=n())
```{r}
pay.gap <- read_csv("UK_gender_pay_gap_2017-18.csv")
pay.gap %>% summarise(mean=mean(DiffMeanHourlyPercent), N=n())
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent)) + geom_histogram(binwidth=1) + xlim(-100, 100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1 observation>100 omitted")
t.test(pay.gap$DiffMeanHourlyPercent)
t.test(DiffMeanHourlyPercent~Sector, data=pay.gap)
```{r}
pay.gap <- mutate(pay.gap, DueDate=dmy_hms(DueDate), Sector=ifelse(DueDate==ymd("2018-03-31"), "Public Sector", "Business / Charity"))
(  pay.gap.by.sector <- pay.gap %>% group_by(Sector) %>% summarise(mean=mean(DiffMeanHourlyPercent), n=n())  )
pay.gap.by.sector %>% summarise(difference=diff(mean))
ggplot(pay.gap) + geom_histogram(aes(x=DiffMeanHourlyPercent), binwidth=1) + facet_grid(Sector~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1   observation>100 omitted") + geom_vline(data=pay.gap.by.sector, mapping=aes(xintercept=mean), col="green")
t.test(DiffMeanHourlyPercent~Sector, data=pay.gap)
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c("True", "False"), labels=c("Late Submissions", "On-Time Submissions")))
(  pay.gap.by.late <- pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))  )
pay.gap.by.late %>% summarise(difference=diff(mean))
pay.gap.by.late %>% summarise(difference=diff(mean))
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c("True", "False"), labels=c("Late Submissions", "On-Time Submissions")))
(  pay.gap.by.late <- pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))  )
pay.gap.by.late %>% summarise(difference=diff(mean))
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent, y=..density..)) + geom_histogram(binwidth=1) + facet_grid(SubmittedAfterTheDeadline~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Density", subtitle="NB 5 observations <100 omitted and 1 observation>100 omitted") + geom_density()
t.test(DiffMeanHourlyPercent~SubmittedAfterTheDeadline, data=pay.gap)
t.test(DiffMeanHourlyPercent~SubmittedAfterTheDeadline, data=pay.gap)
pay.gap.by.late %>% summarise(diff(mean))
gendergap.100 %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent), sd=sd(DiffMeanHourlyPercent, na.rm=TRUE))
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c(TRUE, FALSE), labels=c("Late Submissions", "On-Time Submissions")))
pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))
pay.gap.by.late %>% summarise(difference=diff(mean))
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent, y=..density..)) + geom_histogram(binwidth=1) + facet_grid(SubmittedAfterTheDeadline~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Density", subtitle="NB 5 observations <100 omitted and 1 observation>100 omitted") + geom_density()
pay.gap.by.sector %>% summarise(difference=diff(mean))
ggplot(pay.gap) + geom_histogram(aes(x=DiffMeanHourlyPercent), binwidth=1) + facet_grid(Sector~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1   observation>100 omitted") + geom_vline(data=pay.gap.by.sector, mapping=aes(xintercept=mean), col="green")
t.test(DiffMeanHourlyPercent~Sector, data=pay.gap)
(  pay.gap.by.late <- pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))  )
pay.gap.by.late %>% summarise(difference=diff(mean))
(  pay.gap.by.late <- pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))  )
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c("True", "False"), labels=c("Late Submissions", "On-Time Submissions")))
t.test(DiffMeanHourlyPercent~Sector, data=pay.gap)
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c("True", "False"), labels=c("Late Submissions", "On-Time Submissions")))
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c("True", "False"), labels=c("Late Submissions", "On-Time Submissions")))
(  pay.gap.by.late <- pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))  )
pay.gap.by.late %>% summarise(difference=diff(mean))
