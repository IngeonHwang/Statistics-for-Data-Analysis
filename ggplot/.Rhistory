library(tidyverse)
options(width=100)
(  TP <- read_csv("time_perspective_data.csv")  )
library(tidyverse)
options(width=100)
(  TP <- read_csv("time_perspective_data.csv")  )
(  TP <- read_csv("time_perspective_data.csv")  )
library(tidyverse)
library(lubridate)
options(width=100)
pay.gap <- read_csv("UK_gender_pay_gap_2017-18.csv")
library(tidyverse)
library(lubridate)
options(width=100)
pay.gap <- read_csv("UK_gender_pay_gap_2017-18.csv")
glimpse(pay.gap)
filter(pay.gap, abs(DiffMeanHourlyPercent)>100)
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent)) + geom_histogram(binwidth=1) + xlim(-100, 100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1 observation>100 omitted")
filter(pay.gap, abs(DiffMeanHourlyPercent)>100)
filter(pay.gap, abs(DiffMeanHourlyPercent)>100)
ggplot(pay.gap) + geom_histogram(aes(x=DiffMeanHourlyPercent), binwidth=1) + facet_grid(Sector~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1   observation>100 omitted") + geom_vline(data=pay.gap.by.sector, mapping=aes(xintercept=mean), col="green")
pay.gap <- mutate(pay.gap, DueDate=dmy_hms(DueDate), Sector=ifelse(DueDate==ymd("2018-03-31"), "Public Sector", "Business / Charity"))
(  pay.gap.by.sector <- pay.gap %>% group_by(Sector) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))  )
ggplot(pay.gap) + geom_histogram(aes(x=DiffMeanHourlyPercent), binwidth=1) + facet_grid(Sector~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1   observation>100 omitted") + geom_vline(data=pay.gap.by.sector, mapping=aes(xintercept=mean), col="green")
pay.gap <- pay.gap %>% mutate(SubmittedAfterTheDeadline=factor(SubmittedAfterTheDeadline, levels=c(TRUE, FALSE), labels=c("Late Submissions", "On-Time Submissions")))
pay.gap %>% group_by(SubmittedAfterTheDeadline) %>% summarise(frequency=n(), mean=mean(DiffMeanHourlyPercent))
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent)) + geom_histogram(binwidth=1) + facet_grid(SubmittedAfterTheDeadline~., scales="free_y") + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Frequency", subtitle="NB 5 observations <100 omitted and 1 observation>100 omitted")
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent, y=..density..)) + geom_histogram(binwidth=1) + facet_grid(SubmittedAfterTheDeadline~.) + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Density", subtitle="NB 5 observations <100 omitted and 1 observation>100 omitted") + geom_density()
ggplot(pay.gap, aes(x=DiffMeanHourlyPercent, col=SubmittedAfterTheDeadline)) + stat_ecdf() + xlim(-100,100) + labs(x=expression(frac(Male~Mean-Female~Mean,Male~Mean)*'%'), y="Cumulative Density", col="Submission Timing") + scale_y_continuous(breaks=seq(0,1,0.1))
library(tidyverse)
options(width=100)
(  TP <- read_csv("time_perspective_data.csv")  )
TP.long <- TP %>% gather(time.attitude, time.score, c(future_focus, future_horizon, past_focus, past_horizon)) %>% separate(time.attitude, into=c("time.direction", "time.type"), sep="_")
TP.long
TP.long <- TP %>% gather(time.attitude, time.score, c(future_focus, future_horizon, past_focus, past_horizon)) %>% separate(time.attitude, into=c("time.direction", "time.type"), sep="_")
TP.long
TP.long <- TP.long %>% mutate(time.direction=factor(time.direction, levels=c("future", "past"), labels=c("Future", "Past")))
TP.long <- TP.long %>% mutate(time.type=factor(time.type, levels=c("focus", "horizon"), labels=c("Focus", "Horizon")))
TP.long <- TP.long %>% mutate(year=as.factor(year))
TP.long
TP.long <- TP.long %>% mutate(time.direction=factor(time.direction, levels=c("future", "past"), labels=c("Future", "Past")))
TP.long <- TP.long %>% mutate(time.type=factor(time.type, levels=c("focus", "horizon"), labels=c("Focus", "Horizon")))
TP.long <- TP.long %>% mutate(year=as.factor(year))
ggplot(TP.long, aes(x=time.score, y=gdp)) + geom_point(aes(col=year)) + facet_grid(time.type~time.direction) + scale_y_log10(breaks=c(1000,2000,5000,10000,20000,50000)) + labs(x="Time Score", y="Per-Capita GDP (USD)", col="Year") + geom_smooth(method="lm", col="black")
TP.long
TP.long <- TP.long %>% mutate(time.direction=factor(time.direction, levels=c("future", "past"), labels=c("Future", "Past")))
TP.long <- TP.long %>% mutate(time.type=factor(time.type, levels=c("focus", "horizon"), labels=c("Focus", "Horizon")))
TP.long <- TP.long %>% mutate(year=as.factor(year))
TP.long <- TP.long %>% mutate(year=as.factor(year))
view(TP.long)
